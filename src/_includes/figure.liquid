{% capture imgMarkup %}
  <noscript>
      <img src="{{ figure }}" alt="{{ alt }}" class="block">
  </noscript>
  <img
    data-src="{{ figure }}"
    src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
    alt="{{ alt }}"
    class="lazyload block"
  >
{% endcapture %}

<figure>
{%- if linkHd -%}
  <a href="{{ figure | hdify }}" class="block">
    {{ imgMarkup }}
  </a>
{%- elsif linkExternal -%}
  <a href="{{ linkExternal }}" class="block">
    {{ imgMarkup }}
  </a>
{%- else -%}
  {{ imgMarkup }}
{%- endif -%}
{%- if caption -%}
  <figcaption>{{ caption | markdownify }}</figcaption>
{%- endif -%}
</figure>
